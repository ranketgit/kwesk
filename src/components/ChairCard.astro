---
// ChairCard.astro
interface Version {
  name: string;
  type: string;
}

interface Props {
  title: string;
  description: string;
  image: string;
  versions: Version[];
  imagePosition?: 'left' | 'right';
  href: string;
}

const { title, description, image, versions, imagePosition = 'right', href } = Astro.props;
---

<div class="chair-card py-16 border-t border-stone-200">
  <div class={`max-w-6xl mx-auto px-8 lg:px-16 grid lg:grid-cols-2 gap-12 items-center ${imagePosition === 'left' ? '' : 'lg:flex-row-reverse'}`}>
    
    <!-- Image -->
    <div class={`chair-image ${imagePosition === 'left' ? 'order-1' : 'order-1 lg:order-2'}`}>
      <img src={image} alt={title} class="w-full max-w-sm mx-auto rounded-4xl" />
    </div>

    <!-- Content -->
    <div class={`chair-content space-y-6 ${imagePosition === 'left' ? 'order-2 text-left' : 'order-2 lg:order-1 text-right'}`}>
      <div class={`chair-line w-24 h-0.5 bg-stone-300 ${imagePosition === 'left' ? '' : 'ml-auto'}`}></div>
      
      <h3 class="chair-title text-4xl lg:text-5xl font-bold text-stone-900">{title}</h3>
      
      <p class="chair-desc text-stone-500 leading-relaxed">{description}</p>

      <div class="chair-versions space-y-2">
        <p class="font-semibold text-stone-900">Version</p>
        {versions.map((v) => (
          <p class="text-stone-600">
            <span class="font-semibold">{v.name}</span> {v.type}
          </p>
        ))}
      </div>

      <div class={`chair-btn ${imagePosition === 'left' ? '' : 'flex justify-end'}`}>
        <a 
          href={href} 
          class="inline-block px-8 py-4 text-white text-sm font-medium rounded-3xl transition-transform duration-300 hover:scale-105"
          style="background-color: #8b8b4b;"
        >
          En savoir plus
        </a>
      </div>
    </div>

  </div>
</div>

<style>
  .chair-card {
    --delay: 0ms;
  }

  .chair-image,
  .chair-line,
  .chair-title,
  .chair-desc,
  .chair-versions,
  .chair-btn {
    opacity: 0;
    transform: translateY(40px);
    transition: opacity 0.8s cubic-bezier(0.16, 1, 0.3, 1), 
                transform 0.8s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .chair-card.in-view .chair-image {
    opacity: 1;
    transform: translateY(0);
    transition-delay: 0ms;
  }

  .chair-card.in-view .chair-line {
    opacity: 1;
    transform: translateY(0);
    transition-delay: 100ms;
  }

  .chair-card.in-view .chair-title {
    opacity: 1;
    transform: translateY(0);
    transition-delay: 150ms;
  }

  .chair-card.in-view .chair-desc {
    opacity: 1;
    transform: translateY(0);
    transition-delay: 200ms;
  }

  .chair-card.in-view .chair-versions {
    opacity: 1;
    transform: translateY(0);
    transition-delay: 250ms;
  }

  .chair-card.in-view .chair-btn {
    opacity: 1;
    transform: translateY(0);
    transition-delay: 300ms;
  }
</style>

<script>
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('in-view');
        }
      });
    },
    {
      threshold: 0.2,
      rootMargin: '0px 0px -50px 0px'
    }
  );

  document.querySelectorAll('.chair-card').forEach((card) => {
    observer.observe(card);
  });
</script>